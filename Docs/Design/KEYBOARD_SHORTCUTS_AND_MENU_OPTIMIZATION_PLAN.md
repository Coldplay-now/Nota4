# Nota4 快捷键与菜单优化方案

**文档创建时间**: 2025-11-20 14:35:00  
**文档版本**: v1.0  
**适用范围**: Nota4 v1.1.8+

---

## 一、执行摘要

本文档全面梳理了 Nota4 应用当前的快捷键配置和菜单设计，识别了与 macOS 系统快捷键的冲突，并制定了详细的优化方案。

### 关键发现

1. **快捷键冲突**：发现 3 个与 macOS 系统快捷键的潜在冲突
2. **快捷键不一致**：部分功能在不同位置使用不同的快捷键
3. **菜单结构**：基本符合 macOS 规范，但部分功能缺少菜单入口
4. **快捷键覆盖**：部分常用功能缺少快捷键支持

### 优化目标

1. 消除所有与 macOS 系统快捷键的冲突
2. 统一快捷键定义，确保一致性
3. 完善菜单结构，遵循 macOS 设计规范
4. 为常用功能添加快捷键支持
5. 提供快捷键自定义功能（未来）

---

## 二、当前快捷键完整清单

### 2.1 文件操作快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘N` | 新建笔记 | `Nota4App.swift:22` | ✅ 已实现 | 标准快捷键 |
| `⌘S` | 保存笔记 | `Nota4App.swift:29` | ✅ 已实现 | 标准快捷键 |
| `⇧⌘I` | 导入笔记 | `Nota4App.swift:36` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘E` | 导出笔记 | `Nota4App.swift:49` | ✅ 已实现 | 自定义快捷键 |

### 2.2 编辑操作快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘Z` | 撤销 | `MarkdownTextEditor.swift:395` | ✅ 已实现 | 系统标准 |
| `⇧⌘Z` | 重做 | `MarkdownTextEditor.swift:413` | ✅ 已实现 | 系统标准 |
| `⌘X` | 剪切 | 系统处理 | ✅ 已实现 | 系统标准 |
| `⌘C` | 复制 | 系统处理 | ✅ 已实现 | 系统标准 |
| `⌘V` | 粘贴 | 系统处理 | ✅ 已实现 | 系统标准 |
| `⌘A` | 全选 | 系统处理 | ✅ 已实现 | 系统标准 |

### 2.3 搜索功能快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘F` | 查找 | `Nota4App.swift:65` | ✅ 已实现 | 标准快捷键 |
| `⌘⌥F` | 查找并替换 | `Nota4App.swift:73` | ✅ 已实现 | 自定义快捷键 |
| `⌘G` | 查找下一个 | `Nota4App.swift:80` | ✅ 已实现 | 标准快捷键 |
| `⇧⌘G` | 查找上一个 | `Nota4App.swift:85` | ✅ 已实现 | 标准快捷键 |
| `⌘⌥E` | 替换 | `Nota4App.swift:92` | ✅ 已实现 | 自定义快捷键 |
| `⌘⌥⇧E` | 全部替换 | `Nota4App.swift:97` | ✅ 已实现 | 自定义快捷键 |

### 2.4 视图/布局快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⇧⌘1` | 三栏布局 | `Nota4App.swift:107` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘2` | 两栏布局 | `Nota4App.swift:112` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘3` | 一栏布局 | `Nota4App.swift:117` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘L` | 切换布局模式 | `Nota4App.swift:131` | ✅ 已实现 | 自定义快捷键 |

### 2.5 格式编辑快捷键

#### 2.5.1 文本格式

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘B` | 加粗 | `EditorContextMenu.swift:15` | ✅ 已实现 | 标准快捷键 |
| `⌘I` | 斜体 | `EditorContextMenu.swift:20` | ✅ 已实现 | 标准快捷键 |
| `⌘E` | 行内代码 | `EditorContextMenu.swift:25` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘U` | 下划线 | `IndependentToolbar.swift:166` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘X` | 删除线 | `MarkdownToolbar.swift` | ✅ 已实现 | 自定义快捷键 |

#### 2.5.2 标题格式

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘1` | 标题 1 | `EditorContextMenu.swift:34` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘2` | 标题 2 | `EditorContextMenu.swift:39` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘3` | 标题 3 | `EditorContextMenu.swift:44` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘4` | 标题 4 | `MarkdownToolbar.swift:258` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘5` | 标题 5 | `MarkdownToolbar.swift:263` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘6` | 标题 6 | `MarkdownToolbar.swift:268` | ✅ 已实现 | **⚠️ 冲突** |

**冲突说明**：`⌘1-6` 在 macOS 中用于切换标签页/窗口，与标题格式快捷键冲突。

#### 2.5.3 列表格式

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘L` | 无序列表 | `EditorContextMenu.swift:53` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘L` | 有序列表 | `EditorContextMenu.swift:58` | ✅ 已实现 | **⚠️ 冲突** |
| `⌘⌥L` | 任务列表 | `EditorContextMenu.swift:63` | ✅ 已实现 | 自定义快捷键 |

**冲突说明**：`⇧⌘L` 与"切换布局模式"快捷键冲突。

#### 2.5.4 插入功能

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘K` | 链接 | `EditorContextMenu.swift:72` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘K` | 代码块 | `EditorContextMenu.swift:77` | ✅ 已实现 | 自定义快捷键 |
| `⌘⌥K` | 跨行代码块 | `EditorContextMenu.swift:82` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘A` | 插入附件 | `IndependentToolbar.swift:157` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘Q` | 区块引用 | `MarkdownToolbar.swift:210` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘-` | 分隔线 | `MarkdownToolbar.swift:220` | ✅ 已实现 | 自定义快捷键 |

### 2.6 笔记操作快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘D` | 切换星标 | `EditorContextMenu.swift:91` | ✅ 已实现 | 自定义快捷键 |
| `⇧⌘P` | 切换置顶 | `IndependentToolbar.swift:193` | ✅ 已实现 | 自定义快捷键 |
| `⌘⌫` | 删除笔记 | 未实现 | ❌ 缺失 | 应在菜单中实现 |

### 2.7 设置快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⌘,` | 首选项 | `Nota4App.swift:56` | ✅ 已实现 | 标准快捷键 |

### 2.8 状态栏快捷键

| 快捷键 | 功能 | 实现位置 | 状态 | 备注 |
|--------|------|---------|------|------|
| `⇧⌘1` | 切换到分类视图 | `StatusBarView.swift:36` | ✅ 已实现 | **⚠️ 冲突** |
| `⇧⌘2` | 切换到列表视图 | `StatusBarView.swift:46` | ✅ 已实现 | **⚠️ 冲突** |
| `⇧⌘3` | 切换到编辑视图 | `StatusBarView.swift:56` | ✅ 已实现 | **⚠️ 冲突** |

**冲突说明**：状态栏的 `⇧⌘1-3` 与布局模式的 `⇧⌘1-3` 完全冲突。

---

## 三、macOS 系统快捷键冲突分析

### 3.1 系统保留快捷键

macOS 系统保留的全局快捷键（应用不应覆盖）：

| 快捷键 | 系统功能 | 冲突级别 |
|--------|---------|---------|
| `⌘Q` | 退出应用 | ✅ 已正确使用 |
| `⌘W` | 关闭窗口 | ❌ 未实现（建议添加） |
| `⌘H` | 隐藏应用 | ✅ 系统保留，未使用 |
| `⌘M` | 最小化窗口 | ❌ 未实现（建议添加） |
| `⌘,` | 偏好设置 | ✅ 已正确使用 |
| `⌘?` | 帮助 | ❌ 未实现（建议添加） |
| `⌘Tab` | 应用切换器 | ✅ 系统保留，未使用 |
| `⌘Space` | Spotlight | ✅ 系统保留，未使用 |
| `⌘1-9` | 切换标签页/窗口 | ⚠️ **冲突** |
| `⌘⌥1-9` | 切换标签页/窗口（辅助） | ✅ 未使用 |
| `⌘⇧[` | 上一个标签页 | ✅ 未使用 |
| `⌘⇧]` | 下一个标签页 | ✅ 未使用 |

### 3.2 发现的具体冲突

#### 冲突 1: `⌘1-6` 用于标题格式

**问题**：
- 当前：`⌘1-6` 用于插入标题 1-6
- 系统：`⌘1-9` 用于切换标签页/窗口
- **影响**：在窗口有多个标签页时，`⌘1-6` 会被系统拦截，无法插入标题

**严重程度**：🔴 **高** - 影响核心功能

**解决方案**：
- 方案 A（推荐）：改为 `⌘⌥1-6`（Command + Option + 数字）
- 方案 B：改为 `⌘⇧1-6`（Command + Shift + 数字）
- 方案 C：改为 `⌘⌃1-6`（Command + Control + 数字）

#### 冲突 2: `⇧⌘L` 双重用途

**问题**：
- 当前：`⇧⌘L` 同时用于：
  1. 有序列表（`EditorContextMenu.swift:58`）
  2. 切换布局模式（`Nota4App.swift:131`）
- **影响**：快捷键冲突，行为不确定

**严重程度**：🔴 **高** - 功能冲突

**解决方案**：
- 方案 A（推荐）：保留 `⇧⌘L` 用于切换布局模式，有序列表改为 `⌘⌥L`
- 方案 B：保留 `⇧⌘L` 用于有序列表，切换布局模式改为 `⌘⌥L`

#### 冲突 3: `⇧⌘1-3` 双重用途

**问题**：
- 当前：`⇧⌘1-3` 同时用于：
  1. 布局模式切换（`Nota4App.swift:107-117`）
  2. 状态栏视图切换（`StatusBarView.swift:36-56`）
- **影响**：快捷键冲突，行为不确定

**严重程度**：🔴 **高** - 功能冲突

**解决方案**：
- 方案 A（推荐）：保留 `⇧⌘1-3` 用于布局模式，状态栏视图切换改为 `⌘⌥1-3`
- 方案 B：保留 `⇧⌘1-3` 用于状态栏视图，布局模式改为 `⌘⌥1-3`

### 3.3 潜在冲突（需验证）

| 快捷键 | 当前用途 | 潜在冲突 | 严重程度 |
|--------|---------|---------|---------|
| `⌘E` | 行内代码 | 部分应用用于"使用选中文本搜索" | 🟡 中 |
| `⌘K` | 插入链接 | 部分应用用于"添加链接"（标准） | ✅ 无冲突 |
| `⌘D` | 切换星标 | 部分应用用于"复制"或"删除" | 🟡 中 |

---

## 四、菜单结构分析

### 4.1 当前菜单结构

#### 4.1.1 文件菜单（File）

```
文件
├─ 新建笔记              ⌘N
├─ 保存                  ⌘S
├─ ────────────
├─ 导入笔记...           ⇧⌘I
└─ 导出笔记...           ⇧⌘E
```

**分析**：
- ✅ 基本符合 macOS 规范
- ❌ 缺少"打开"（`⌘O`）功能（虽然应用是单窗口，但可以考虑用于导入）
- ❌ 缺少"关闭窗口"（`⌘W`）

#### 4.1.2 编辑菜单（Edit）

```
编辑
├─ 撤销                  ⌘Z
├─ 重做                  ⇧⌘Z
├─ ────────────
├─ 剪切                  ⌘X
├─ 复制                  ⌘C
├─ 粘贴                  ⌘V
├─ ────────────
├─ 全选                  ⌘A
├─ ────────────
├─ 查找                  ⌘F
├─ 查找并替换            ⌘⌥F
├─ ────────────
├─ 查找下一个            ⌘G
└─ 查找上一个            ⇧⌘G
```

**分析**：
- ✅ 基本符合 macOS 规范
- ✅ 搜索功能完整
- ❌ 缺少"粘贴并匹配样式"（`⇧⌘V`）

#### 4.1.3 视图菜单（View）

```
视图
├─ 布局模式
│  ├─ 三栏（分类 + 列表 + 编辑）  ⇧⌘1
│  ├─ 两栏（列表 + 编辑）        ⇧⌘2
│  └─ 一栏（仅编辑）              ⇧⌘3
├─ ────────────
└─ 切换布局模式                  ⇧⌘L
```

**分析**：
- ✅ 布局模式切换清晰
- ❌ 缺少"显示/隐藏侧边栏"功能
- ❌ 缺少"显示/隐藏大纲"功能
- ❌ 缺少"进入全屏"（`⌃⌘F`）

#### 4.1.4 格式菜单（Format）

**当前状态**：❌ **缺失**

**建议添加**：
```
格式
├─ 加粗                  ⌘B
├─ 斜体                  ⌘I
├─ 下划线                ⇧⌘U
├─ 删除线                ⇧⌘X
├─ ────────────
├─ 标题
│  ├─ 标题 1             ⌘⌥1  (修改后)
│  ├─ 标题 2             ⌘⌥2  (修改后)
│  ├─ 标题 3             ⌘⌥3  (修改后)
│  ├─ 标题 4             ⌘⌥4  (修改后)
│  ├─ 标题 5             ⌘⌥5  (修改后)
│  └─ 标题 6             ⌘⌥6  (修改后)
├─ ────────────
├─ 列表
│  ├─ 无序列表           ⌘L
│  ├─ 有序列表           ⌘⌥L  (修改后)
│  └─ 任务列表           ⌘⌥L  (修改后)
├─ ────────────
├─ 插入
│  ├─ 链接               ⌘K
│  ├─ 代码块             ⇧⌘K
│  ├─ 跨行代码块         ⌘⌥K
│  ├─ 行内代码           ⌘E
│  ├─ 区块引用           ⇧⌘Q
│  └─ 分隔线             ⇧⌘-
└─ ────────────
└─ 插入附件              ⇧⌘A
```

#### 4.1.5 笔记菜单（Note）

**当前状态**：❌ **缺失**

**建议添加**：
```
笔记
├─ 星标笔记              ⌘D
├─ 置顶笔记              ⇧⌘P
├─ ────────────
├─ 添加标签...
├─ ────────────
├─ 移至废纸篓            ⌘⌫
└─ 永久删除              ⇧⌘⌫
```

#### 4.1.6 窗口菜单（Window）

**当前状态**：❌ **缺失**

**建议添加**：
```
窗口
├─ 最小化                ⌘M
├─ 缩放
├─ ────────────
└─ 前置全部窗口
```

#### 4.1.7 帮助菜单（Help）

**当前状态**：❌ **缺失**

**建议添加**：
```
帮助
├─ Nota4 帮助            ⌘?
└─ 快捷键...
```

### 4.2 右键菜单（Context Menu）

#### 4.2.1 编辑器右键菜单

**当前实现**：`EditorContextMenu.swift`

**菜单结构**：
```
加粗                    ⌘B
斜体                    ⌘I
行内代码                ⌘E
────────────
标题 1                  ⌘1  (需修改)
标题 2                  ⌘2  (需修改)
标题 3                  ⌘3  (需修改)
────────────
无序列表                ⌘L
有序列表                ⇧⌘L  (需修改)
任务列表                ⌘⌥L
────────────
链接                    ⌘K
代码块                  ⇧⌘K
跨行代码块              ⌘⌥K
────────────
切换星标                ⌘D
```

**分析**：
- ✅ 功能完整
- ⚠️ 快捷键需要修改以避免冲突

#### 4.2.2 笔记列表右键菜单

**当前状态**：需检查实现

**建议结构**：
```
打开笔记
────────────
星标 / 取消星标          ⌘D
置顶 / 取消置顶          ⇧⌘P
────────────
添加标签...
────────────
移至废纸篓              ⌘⌫
```

---

## 五、优化方案

### 5.1 快捷键冲突解决

#### 方案 1: 标题格式快捷键修改（高优先级）

**当前问题**：`⌘1-6` 与系统快捷键冲突

**推荐方案**：改为 `⌘⌥1-6`

**理由**：
- `⌘⌥1-6` 不与系统快捷键冲突
- Option 键常用于格式相关功能
- 符合其他 Markdown 编辑器的习惯（如 Typora）

**实施步骤**：
1. 修改 `EditorContextMenu.swift` 中的标题快捷键
2. 修改 `MarkdownToolbar.swift` 中的标题快捷键
3. 更新所有相关文档和帮助文本

#### 方案 2: 有序列表快捷键修改（高优先级）

**当前问题**：`⇧⌘L` 与布局切换快捷键冲突

**推荐方案**：有序列表改为 `⌘⌥L`

**理由**：
- 保留 `⇧⌘L` 用于布局切换（更常用）
- `⌘⌥L` 不与系统快捷键冲突
- 任务列表已使用 `⌘⌥L`，需要调整

**调整方案**：
- 有序列表：`⌘⌥L`
- 任务列表：`⌘⌥⇧L` 或 `⌘⌃L`

#### 方案 3: 状态栏视图切换快捷键修改（高优先级）

**当前问题**：`⇧⌘1-3` 与布局模式快捷键冲突

**推荐方案**：状态栏视图切换改为 `⌘⌥1-3`

**理由**：
- 布局模式切换更常用，保留 `⇧⌘1-3`
- `⌘⌥1-3` 不与系统快捷键冲突
- 状态栏视图切换使用频率较低

### 5.2 缺失快捷键补充

#### 补充 1: 窗口操作快捷键

| 快捷键 | 功能 | 优先级 |
|--------|------|--------|
| `⌘W` | 关闭窗口 | 🔴 高 |
| `⌘M` | 最小化窗口 | 🟡 中 |
| `⌃⌘F` | 进入/退出全屏 | 🟡 中 |

#### 补充 2: 笔记操作快捷键

| 快捷键 | 功能 | 优先级 |
|--------|------|--------|
| `⌘⌫` | 删除笔记（移至废纸篓） | 🔴 高 |
| `⇧⌘⌫` | 永久删除笔记 | 🟡 中 |

#### 补充 3: 视图操作快捷键

| 快捷键 | 功能 | 优先级 |
|--------|------|--------|
| `⌘⌥O` | 显示/隐藏大纲 | 🟡 中 |
| `⌘⌥S` | 显示/隐藏侧边栏 | 🟡 中 |

### 5.3 菜单结构优化

#### 优化 1: 添加格式菜单

**优先级**：🔴 高

**理由**：
- macOS 标准应用通常有格式菜单
- 方便用户查找格式相关功能
- 提供快捷键参考

#### 优化 2: 添加笔记菜单

**优先级**：🔴 高

**理由**：
- 集中管理笔记相关操作
- 提供快捷键入口
- 符合应用的功能组织

#### 优化 3: 添加窗口菜单

**优先级**：🟡 中

**理由**：
- macOS 标准菜单
- 提供窗口操作入口
- 符合用户习惯

#### 优化 4: 添加帮助菜单

**优先级**：🟡 中

**理由**：
- macOS 标准菜单
- 提供帮助和快捷键参考
- 提升用户体验

### 5.4 快捷键一致性优化

#### 问题 1: 同一功能在不同位置使用不同快捷键

**示例**：
- 标题格式在 `EditorContextMenu` 和 `MarkdownToolbar` 中定义
- 需要确保一致性

**解决方案**：
- 创建统一的快捷键常量定义
- 所有组件引用同一常量

#### 问题 2: 快捷键显示不一致

**当前问题**：
- 工具栏按钮显示快捷键（如 `⌘B`）
- 菜单项显示快捷键
- 但格式可能不一致

**解决方案**：
- 统一快捷键显示格式
- 使用系统标准的快捷键显示方式

---

## 六、实施计划

### 6.1 第一阶段：解决冲突（高优先级）

**目标**：消除所有快捷键冲突

**任务清单**：
- [ ] 修改标题格式快捷键：`⌘1-6` → `⌘⌥1-6`
- [ ] 修改有序列表快捷键：`⇧⌘L` → `⌘⌥L`（有序列表）
- [ ] 修改状态栏视图切换快捷键：`⇧⌘1-3` → `⌘⌥1-3`
- [ ] 调整任务列表快捷键（避免与有序列表冲突）
- [ ] 测试所有修改后的快捷键
- [ ] 更新文档和帮助文本

**预计时间**：2-3 小时

### 6.2 第二阶段：补充缺失功能（中优先级）

**目标**：添加缺失的快捷键和菜单

**任务清单**：
- [ ] 添加窗口操作快捷键（`⌘W`, `⌘M`, `⌃⌘F`）
- [ ] 添加笔记操作快捷键（`⌘⌫`, `⇧⌘⌫`）
- [ ] 添加视图操作快捷键（`⌘⌥O`, `⌘⌥S`）
- [ ] 创建格式菜单
- [ ] 创建笔记菜单
- [ ] 创建窗口菜单
- [ ] 创建帮助菜单
- [ ] 测试所有新功能

**预计时间**：4-6 小时

### 6.3 第三阶段：优化和统一（低优先级）

**目标**：提升一致性和用户体验

**任务清单**：
- [ ] 创建统一的快捷键常量定义
- [ ] 统一快捷键显示格式
- [ ] 添加快捷键帮助文档
- [ ] 优化菜单组织结构
- [ ] 添加快捷键自定义功能（可选）

**预计时间**：3-4 小时

---

## 七、快捷键最终方案（推荐）

### 7.1 文件操作

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘N` | 新建笔记 | ✅ 保持 |
| `⌘S` | 保存笔记 | ✅ 保持 |
| `⌘O` | 打开/导入笔记 | 🆕 新增 |
| `⌘W` | 关闭窗口 | 🆕 新增 |
| `⇧⌘I` | 导入笔记 | ✅ 保持 |
| `⇧⌘E` | 导出笔记 | ✅ 保持 |

### 7.2 编辑操作

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘Z` | 撤销 | ✅ 保持 |
| `⇧⌘Z` | 重做 | ✅ 保持 |
| `⌘X` | 剪切 | ✅ 保持 |
| `⌘C` | 复制 | ✅ 保持 |
| `⌘V` | 粘贴 | ✅ 保持 |
| `⇧⌘V` | 粘贴并匹配样式 | 🆕 新增 |
| `⌘A` | 全选 | ✅ 保持 |

### 7.3 搜索功能

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘F` | 查找 | ✅ 保持 |
| `⌘⌥F` | 查找并替换 | ✅ 保持 |
| `⌘G` | 查找下一个 | ✅ 保持 |
| `⇧⌘G` | 查找上一个 | ✅ 保持 |
| `⌘⌥E` | 替换 | ✅ 保持 |
| `⌘⌥⇧E` | 全部替换 | ✅ 保持 |

### 7.4 视图/布局

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⇧⌘1` | 三栏布局 | ✅ 保持 |
| `⇧⌘2` | 两栏布局 | ✅ 保持 |
| `⇧⌘3` | 一栏布局 | ✅ 保持 |
| `⇧⌘L` | 切换布局模式 | ✅ 保持 |
| `⌘⌥1` | 切换到分类视图 | 🔄 修改 |
| `⌘⌥2` | 切换到列表视图 | 🔄 修改 |
| `⌘⌥3` | 切换到编辑视图 | 🔄 修改 |
| `⌘⌥O` | 显示/隐藏大纲 | 🆕 新增 |
| `⌘⌥S` | 显示/隐藏侧边栏 | 🆕 新增 |
| `⌃⌘F` | 进入/退出全屏 | 🆕 新增 |

### 7.5 格式编辑

#### 文本格式

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘B` | 加粗 | ✅ 保持 |
| `⌘I` | 斜体 | ✅ 保持 |
| `⇧⌘U` | 下划线 | ✅ 保持 |
| `⇧⌘X` | 删除线 | ✅ 保持 |
| `⌘E` | 行内代码 | ✅ 保持 |

#### 标题格式

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘⌥1` | 标题 1 | 🔄 修改 |
| `⌘⌥2` | 标题 2 | 🔄 修改 |
| `⌘⌥3` | 标题 3 | 🔄 修改 |
| `⌘⌥4` | 标题 4 | 🔄 修改 |
| `⌘⌥5` | 标题 5 | 🔄 修改 |
| `⌘⌥6` | 标题 6 | 🔄 修改 |

#### 列表格式

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘L` | 无序列表 | ✅ 保持 |
| `⌘⌥L` | 有序列表 | 🔄 修改 |
| `⌘⌥⇧L` | 任务列表 | 🔄 修改 |

#### 插入功能

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘K` | 链接 | ✅ 保持 |
| `⇧⌘K` | 代码块 | ✅ 保持 |
| `⌘⌥K` | 跨行代码块 | ✅ 保持 |
| `⇧⌘A` | 插入附件 | ✅ 保持 |
| `⇧⌘Q` | 区块引用 | ✅ 保持 |
| `⇧⌘-` | 分隔线 | ✅ 保持 |

### 7.6 笔记操作

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘D` | 切换星标 | ✅ 保持 |
| `⇧⌘P` | 切换置顶 | ✅ 保持 |
| `⌘⌫` | 移至废纸篓 | 🆕 新增 |
| `⇧⌘⌫` | 永久删除 | 🆕 新增 |

### 7.7 设置和帮助

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `⌘,` | 首选项 | ✅ 保持 |
| `⌘?` | 帮助 | 🆕 新增 |
| `⌘M` | 最小化窗口 | 🆕 新增 |

---

## 八、菜单最终方案（推荐）

### 8.1 文件菜单（File）

```
文件
├─ 新建笔记              ⌘N
├─ 打开...               ⌘O  (新增)
├─ 保存                  ⌘S
├─ ────────────
├─ 导入笔记...           ⇧⌘I
├─ 导出笔记...           ⇧⌘E
├─ ────────────
└─ 关闭窗口              ⌘W  (新增)
```

### 8.2 编辑菜单（Edit）

```
编辑
├─ 撤销                  ⌘Z
├─ 重做                  ⇧⌘Z
├─ ────────────
├─ 剪切                  ⌘X
├─ 复制                  ⌘C
├─ 粘贴                  ⌘V
├─ 粘贴并匹配样式        ⇧⌘V  (新增)
├─ ────────────
├─ 全选                  ⌘A
├─ ────────────
├─ 查找                  ⌘F
├─ 查找并替换            ⌘⌥F
├─ ────────────
├─ 查找下一个            ⌘G
└─ 查找上一个            ⇧⌘G
```

### 8.3 格式菜单（Format）- 新增

```
格式
├─ 加粗                  ⌘B
├─ 斜体                  ⌘I
├─ 下划线                ⇧⌘U
├─ 删除线                ⇧⌘X
├─ ────────────
├─ 标题
│  ├─ 标题 1             ⌘⌥1
│  ├─ 标题 2             ⌘⌥2
│  ├─ 标题 3             ⌘⌥3
│  ├─ 标题 4             ⌘⌥4
│  ├─ 标题 5             ⌘⌥5
│  └─ 标题 6             ⌘⌥6
├─ ────────────
├─ 列表
│  ├─ 无序列表           ⌘L
│  ├─ 有序列表           ⌘⌥L
│  └─ 任务列表           ⌘⌥⇧L
├─ ────────────
├─ 插入
│  ├─ 链接               ⌘K
│  ├─ 代码块             ⇧⌘K
│  ├─ 跨行代码块         ⌘⌥K
│  ├─ 行内代码           ⌘E
│  ├─ 区块引用           ⇧⌘Q
│  └─ 分隔线             ⇧⌘-
└─ ────────────
└─ 插入附件              ⇧⌘A
```

### 8.4 视图菜单（View）

```
视图
├─ 布局模式
│  ├─ 三栏（分类 + 列表 + 编辑）  ⇧⌘1
│  ├─ 两栏（列表 + 编辑）        ⇧⌘2
│  └─ 一栏（仅编辑）              ⇧⌘3
├─ ────────────
├─ 切换布局模式                  ⇧⌘L
├─ ────────────
├─ 显示/隐藏侧边栏              ⌘⌥S  (新增)
├─ 显示/隐藏大纲                ⌘⌥O  (新增)
├─ ────────────
└─ 进入全屏                      ⌃⌘F  (新增)
```

### 8.5 笔记菜单（Note）- 新增

```
笔记
├─ 星标笔记              ⌘D
├─ 置顶笔记              ⇧⌘P
├─ ────────────
├─ 添加标签...
├─ ────────────
├─ 移至废纸篓            ⌘⌫  (新增)
└─ 永久删除              ⇧⌘⌫  (新增)
```

### 8.6 窗口菜单（Window）- 新增

```
窗口
├─ 最小化                ⌘M  (新增)
├─ 缩放
├─ ────────────
└─ 前置全部窗口
```

### 8.7 帮助菜单（Help）- 新增

```
帮助
├─ Nota4 帮助            ⌘?  (新增)
└─ 快捷键...             ⌘?⇧  (可选)
```

---

## 九、实施注意事项

### 9.1 向后兼容性

**问题**：修改快捷键可能影响现有用户习惯

**解决方案**：
1. 在更新日志中明确说明快捷键变更
2. 提供快捷键迁移指南
3. 考虑添加快捷键自定义功能（未来）

### 9.2 测试要求

**测试范围**：
1. 所有快捷键功能测试
2. 快捷键冲突测试
3. 菜单功能测试
4. 不同 macOS 版本兼容性测试

### 9.3 文档更新

**需要更新的文档**：
1. 用户手册
2. 快捷键参考文档
3. 帮助菜单内容
4. README 文件

---

## 十、总结

### 10.1 关键发现

1. **3 个高优先级冲突**需要立即解决
2. **多个菜单缺失**，需要补充
3. **快捷键定义分散**，需要统一管理
4. **部分常用功能缺少快捷键**，需要补充

### 10.2 优化收益

1. **消除冲突**：提升用户体验，避免功能失效
2. **完善菜单**：符合 macOS 设计规范
3. **统一管理**：便于维护和扩展
4. **提升效率**：为常用功能提供快捷键

### 10.3 下一步行动

1. **立即执行**：解决 3 个高优先级冲突
2. **短期计划**：补充缺失的菜单和快捷键
3. **长期规划**：考虑添加快捷键自定义功能

---

**文档维护者**: Nota4 开发团队  
**最后更新**: 2025-11-20 14:35:00  
**文档状态**: ✅ 待实施


