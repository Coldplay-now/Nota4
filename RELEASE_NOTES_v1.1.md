# Nota4 v1.1 发布说明

**发布日期**: 2025-11-17  
**版本号**: 1.1  
**构建号**: 2  
**架构**: arm64 (Apple Silicon)

## 🎉 主要更新

### ✨ 新功能

1. **编辑器工具栏搜索功能**
   - 新增独立的搜索按钮，支持文章内全文搜索
   - 支持搜索和替换模式切换
   - 搜索结果实时高亮显示
   - 集成系统 Undo/Redo 支持
   - 紧凑优化的按钮和面板设计

2. **图片预览功能完全修复**
   - 修复本地图片无法在预览区显示的问题
   - 解决 macOS Sandbox 权限限制
   - 支持相对路径和绝对路径图片
   - 自动标记损坏的图片链接
   - 实现图片文件清理机制

### 🎨 UI/UX 优化

1. **笔记列表优化**
   - 现代化的卡片设计
   - 更清晰的选中状态（橙色左边框）
   - 卡片位置变化的平滑动画
   - Hover 效果增强

2. **搜索功能优化**
   - 列表和正文的搜索结果高亮颜色提升（橙色和蓝色）
   - 标题和内容中的关键词高亮
   - 代码块和引用块中的搜索结果正确高亮

3. **工具栏优化**
   - 统一的按钮风格
   - 更紧凑有效的布局
   - 搜索面板左对齐设计

### 🐛 Bug 修复

1. **编辑器**
   - 修复标题编辑时焦点跳转问题
   - 修复搜索/替换后 Undo 功能失效
   - 优化编辑器右键菜单（保留系统功能，添加中文 Undo/Redo）

2. **列表**
   - 修复新建笔记后列表焦点不自动落在新笔记上
   - 修复单选和批量删除功能失效
   - 修复删除笔记后分类栏计数不更新
   - 修复列表多选功能

3. **图片渲染**
   - 完全解决 Sandbox 权限问题
   - 使用 `loadFileURL` 替代 `loadHTMLString`
   - 临时 HTML 文件放置策略优化
   - 图片路径自动转换为完整 URL

### 🔧 技术改进

1. **代码质量**
   - 清理冗余调试日志
   - 保留关键错误日志
   - 优化 TCA 状态管理
   - 改进异步操作处理

2. **性能优化**
   - 搜索防抖优化
   - 标题保存防抖优化
   - 渲染性能提升

3. **文档完善**
   - 新增完整的问题分析文档
   - 更新 PRD 和技术文档
   - 添加调试指南

## 📦 安装信息

### 系统要求
- **最低系统版本**: macOS 13.0 (Ventura)
- **推荐系统版本**: macOS 14.0 (Sonoma) 或更高
- **处理器**: Apple Silicon (M1/M2/M3/M4)
  - Intel Mac 可通过 Rosetta 2 运行

### 安装方式
1. 下载 `Nota4-Installer-v1.1.dmg`
2. 双击打开 DMG 文件
3. 拖拽 Nota4.app 到 Applications 文件夹
4. 首次启动时，系统可能会提示安全确认，请选择"打开"

### 安全认证
- ✅ 应用已使用 Apple Developer ID 签名
- ✅ 已通过 Apple 公证 (Notarized)
- ✅ 已通过 Gatekeeper 验证
- ✅ 启用 Hardened Runtime

## 🔄 从 v1.0.x 升级

### 数据兼容性
- ✅ 完全兼容 v1.0.x 的数据
- ✅ 自动迁移笔记和数据库
- ✅ 保留所有用户设置

### 升级建议
1. **备份数据**（可选但推荐）
   - 笔记数据位置: `~/Library/Containers/com.nota4.Nota4/Data/Documents/NotaLibrary`
   - 建议先备份此目录

2. **卸载旧版本**（可选）
   - 关闭 Nota4 v1.0.x
   - 删除 Applications 中的旧版本

3. **安装新版本**
   - 按照上述安装步骤进行

4. **首次启动**
   - 首次启动会自动检查和迁移数据
   - 确认笔记和设置正常加载

## 📝 已知问题

### 当前版本限制
1. **架构限制**
   - 本版本仅构建 arm64 架构
   - Intel Mac 需要通过 Rosetta 2 运行
   - 性能在 Apple Silicon 上最佳

2. **功能限制**
   - 置顶功能的图标显示已实现，但排序逻辑待完善
   - 部分主题 CSS 文件路径需要调整

### 计划中的改进
- [ ] 构建 Universal Binary（arm64 + x86_64）
- [ ] 完善置顶功能的排序逻辑
- [ ] 优化主题系统的资源加载
- [ ] 添加更多编辑器功能

## 🙏 感谢

感谢所有测试用户的反馈和建议！

## 📧 联系方式

- **问题反馈**: [GitHub Issues](https://github.com/Coldplay-now/Nota4/issues)
- **Email**: lxiaotian@gmail.com

## 📄 许可证

本软件遵循 MIT 许可证。

---

**Happy Note-Taking! 📝**





